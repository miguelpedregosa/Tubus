var yqlgeo=function(){function i(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){f(a.coords.latitude,a.coords.longitude)},function(){g()}):g()}function h(a){e('select * from geo.places where woeid in (select place.woeid from flickr.places where (lat,lon) in(select Latitude,Longitude from ip.location where ip="'+a+'"))',"yqlgeo.retrieved")}function g(){if(document.getElementById("yqlgeodata")){var a=document.getElementById("yqlgeodata");a.parentNode.removeChild(a)}var a=
document.getElementsByTagName("head")[0],b=document.createElement("script");b.setAttribute("id","yqlgeodata");b.setAttribute("src","http://jsonip.appspot.com/?callback=yqlgeo.ipin");a.appendChild(b)}function f(a,b){e("select * from geo.places where woeid in (select place.woeid from flickr.places where lat="+a+" and  lon="+b+")","yqlgeo.retrieved")}function e(a,b){if(document.getElementById("yqlgeodata")){var c=document.getElementById("yqlgeodata");c.parentNode.removeChild(c)}var c="http://query.yahooapis.com/v1/public/yql?q="+
encodeURIComponent(a)+"&format=json&callback="+b+"&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys",e=document.getElementsByTagName("head")[0],d=document.createElement("script");d.setAttribute("id","yqlgeodata");d.setAttribute("src",c);e.appendChild(d)}var d;return{get:function(){for(var a=arguments,b=0;b<a.length;b++)typeof a[b]==="function"&&(d=a[b]);a[0]==="visitor"&&i();typeof a[0]==="string"&&a[0]!="visitor"&&a[0]&&(/^http:\/\/.*/.test(a[0])?e('select * from geo.places where woeid in (select match.place.woeId from geo.placemaker where documentURL="'+
a[0]+'" and documentType="text/html" and appid="")',"yqlgeo.retrieved"):/^[\d+\.?]+$/.test(a[0])?h(a[0]):e('select * from geo.places where woeid in (select match.place.woeId from geo.placemaker where documentContent = "'+a[0]+'" and documentType="text/plain" and appid = "")',"yqlgeo.retrieved"));var b=a[0],c=a[1];typeof b.join!==void 0&&a[0][1]&&(b=a[0][0],c=a[0][1]);isFinite(b)&&isFinite(c)&&b>-90&&b<90&&c>-180&&c<180&&f(b,c)},retrieved:function(a){a.query.results?d(a.query.results):d({error:a.query})},
ipin:function(a){h(a.ip)}}}();
